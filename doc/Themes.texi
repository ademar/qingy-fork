@node  Qingy Themes, Copying, The settings file, Top
@comment  node-name,  next,  previous,  up
@chapter Qingy Themes
Qingy @value{VERSION} is completely customizable in its appearence
through a theming interface. We shall see how these themes are made
and used and what is possible to be done with themes in Qingy.

@menu
* Compatibility note::          
* Introduction to themes::      
* Themes using theme files::    
* Themes using settings file::  
@end menu

@node Compatibility note, Introduction to themes, Qingy Themes, Qingy Themes
@section Compatibility note

Settings and theme file syntax and semantics have radically changed since
version 0.2. Hence, old-style themes are no longer compatible with
Qingy.  Please read thouroughly this file and change your themes
appropriately. 


@node Introduction to themes, Themes using theme files, Compatibility note, Qingy Themes
@section Introduction to themes
For qingy 0.2, a theme was a subdirectory in @file{/etc/qingy}.
The name of this directory was the name of the theme.
You could select a theme by editing @file{/etc/qingy/settings}
and modifying the line @code{THEME default} with the name of the
theme you wanted to use (e.g.: @code{THEME playboy}).

This is still true in Qingy @value{VERSION}, although the rules vary. 

Still, it is also possible to define themes in a different way:
directly in the settings file. This way, you might have some
properties which are always set in a certain way, while others are set
by the theme files.

It is also possible to include many theme files. The rules will be
added incrementally: that is, new settings will override old ones.

@node  Themes using theme files, Themes using settings file, Introduction to themes, Qingy Themes
@comment  node-name,  next,  previous,  up
@section Themes using theme files

As said, a theme may be a directory in @file{/etc/qingy}. The
subdirectory name will be the name of the theme. 

In this directory, you should put: 
@itemize @bullet
@item
A background image.

@item
A font file supported by DirectFB. TTF fonts are OK.

@item
Two images for each button you want, one for it's normal appearance
(filename: @file{@code{stem}_normal.png}), one for when mouse passes
over it (filename:@file{@code{stem}_mouseover.png}).

@code{stem} is a name of your choice, but must be the same for the same button.

@item
A config file (filename:@file{theme}). See forward to know how to write that.

@end itemize

@menu
* The theme file::              
* theme file examples::         
@end menu

@node  The theme file, theme file examples, Themes using theme files, Themes using theme files
@comment  node-name,  next,  previous,  up
@subsection The theme file
The file called @file{theme} in your theme directory is what gives the
rules for your theme. You can set the actual theme there (the look and
feel of Qingy), a screensaver and the widget disposition.

In the @file{theme} file, everything after a @code{#} is considered
comment and ignored. 

@menu
* Screensaver setting::         
* Theme::                       
* Windows::                     
@end menu

@node  Screensaver setting, Theme, The theme file, The theme file
@comment  node-name,  next,  previous,  up
@subsubsection Screensaver setting

You can set a screensaver putting on a line the following:
@code{screensaver=pixel} or @code{screensaver=photo "/path/to/pics"
"path/to/pics" ...}.

@node  Theme, Windows, Screensaver setting, The theme file
@comment  node-name,  next,  previous,  up
@subsubsection ``Theme''

You can set a ``theme'' (look and feel) making a @code{theme@{...@}} block.

Therein you can set various properties, as assignments:

     @multitable @columnfractions .35 .35 .3
     @item @code{mask_text_color} =
     @tab @code{color}
     @tab The color of the text in the login window
@item
     @item @code{cursor_text_color} = 
     @tab @code{color}
     @tab The color of the blinking cursor
@item
     @item @code{other_text_color} =
     @tab @code{color}
     @tab The color of the text of other windows (such as the shutdown
     window)
@item
     @item @code{background} = 
     @tab @code{"/path/to/file"}
     @tab The background image file pathname
@item
     @item @code{font} =
     @tab @code{"/path/to/file"}
     @tab The font file pathname
@item
     @item @code{button_opacity} =
     @tab @code{number}
     @tab Alpha channel value for buttons
@item
     @item @code{window_opacity} =
     @tab @code{number}
     @tab Foreground alpha channel value of windows
@item
     @item @code{selected_window_opacity} =
     @tab @code{number}
     @tab Foreground alpha channel value for the active window
     @end multitable

A @code{color} might be a hexadecimal quadruplet in the form of
@code{[aabbccdd]}, which will set the red value to 0xAA, the green
value to 0xBB, the blue value to 0xCC and the alpha channel value to
0xDD. Or, it might be four decimal value comma-separated fields such
as @code{20, 30, 40, 50}, which will set the red value to 20, the
green value to 30, the blue value to 40 and the alpha channel value to
50. The opacity numbers must be unsigned integer decimal values,
ranging from 0 to 255.

@node   Windows,  , Theme, The theme file
@comment  node-name,  next,  previous,  up
@subsubsection Windows

Finally, you can define windows on your screen. In Qingy, a
@dfn{window} is any visible widget to be displayed. 

Each window is defined inside a @code{window@{...@}} block.  Therein
you can define some fields to define the position, size and behaviour
of the window.

The fields you can set are the following:


@multitable @columnfractions .20 .15 .55
     @item @code{x} =
     @tab @code{number}
     @tab The left column of the window
@item
     @item @code{y} =
     @tab @code{number}
     @tab The top row of the window
@item
     @item @code{height} =
     @tab @code{number}
     @tab The height in pixels of the window
@item
     @item @code{width} =
     @tab @code{number}
     @tab The width in pixels of the window
@item
     @item @code{type} =
     @tab @code{"type"}
     @tab The type of the window (see below)
@item
     @item @code{command} = 
     @tab @code{"command"}
     @tab Command to be executed (see below)
@item
     @item @code{content} = 
     @tab @code{"content"}
     @tab Content of the widget (see below)
@item
     @item @code{polltime} =
     @tab @code{number}
     @tab Seconds interval for command polling (see below)
@end multitable
     
The type of a window must be one in the following:

@table @b

@item label
Displays a text label with a certain text at given position.
The displayed text can be either static, given as the @code{content}
field or dynamic, as the output of a shell command, given in the
@code{command} field. In this case, the command is run every
@code{polltime} seconds and its output redisplayed. If polltime is set
to 0, command is executed just once.

@item button
Displays a button at given position. 
Command must be one of @code{halt}, @code{reboot}, @code{sleep} or
@code{screensave}.
Commands @code{halt} and @code{reboot} will be executed (hence halting
the system or rebooting it) following the @dfn{shutdown policy}
@ifnotplaintext
     (@pxref{The settings file})
@end ifnotplaintext
.
In the @code{content} field, you should put a
@code{/path/to/stem}. You should also have files
@file{/path/to/stem_normal.png} and
@file{/path/to/stem_mouseover.png}. These are two images that will be
used to display your button respectively normally and when the mouse
is on them.

@item login
A login text box. Users will have to write their username here in
order to log in. There should be always one and just one of these on
your window. Having none will result in displaying a default one,
having more than one will result in an error.

@item password
A login text box. Users will have to write their password here in
order to log in. There should be always one and just one of these on
your window. Having none will result in displaying a default one,
having more than one will result in an error.

@item combo
Displays a combo box at given position. 
The only command supported so far is @code{sessions}. It will let user
choose which session run at login.

@end table

Whenever a field is set for a window with a type not using that field,
the value of the field is silently ignored.

@node  theme file examples,  , The theme file, Themes using theme files
@comment  node-name,  next,  previous,  up
@subsection theme file examples

We shall see some examples of the file @file{theme} of a theme.

@menu
* A basic theme::               
* A complete theme::            
@end menu

@node  A basic theme, A complete theme, theme file examples, theme file examples
@comment  node-name,  next,  previous,  up
@subsubsection A basic theme
@verbatim
# basic theme for Qingy 0.3
# by Paolo Gianrossi

theme @{
      background = "bg.png"
      font = "decker.ttf"
      window_opacity = 240
      selected_window_opacity = 255
      mask_text_color = 90, 200, 90
      cursor_text_color = 90, 200, 90
      other_text_color = 90, 200, 90
@}
@end verbatim

In this case, only the look and feel was set. No buttons are used,
hence @code{button_opacity} is not defined. Color is uniform, a
greenish fade. The selected window is more vivid than the rest, due to
@code{selected_window_opacity}. 

@node  A complete theme,  , A basic theme, theme file examples
@comment  node-name,  next,  previous,  up
@subsubsection A complete theme

@verbatim

screensaver=pixel

theme
{	
	background = "background.png"
	font = "decker.ttf"

# opacity values, from 0 (transparent) to 255 (opaque)
	button_opacity          = 128
	window_opacity          = 128
	selected_window_opacity = 207

# Colors can be given in a hex quadruplet (values from 00 to ff)
# or via comma-separated decimals (0 to 255). Format is RGBA
#	mask_text_color   = [ 28b428ff ]
#	cursor_text_color = [ 145a14dd ]
#	other_text_color  = [ 404040ff ]
	default_text_color   = 70,70, 240, 255
	default_cursor_color = 70,  70, 240, 221
	other_text_color     =  70,70 , 255, 255
}

window
{
	# window geometry
	x      = 0
	y      = 20
	width  = 780
	height = 200

	text_size        = small
	text_orientation = center
	text_color       = 00, 0, 240, 255
	cursor_color     = 00, 0,  240, 221

	# update time, 0 means do not update
	time = 0

	# window type, allowed values are:
	# "label", "button", "login", "password", "combo"
	type    = "label"
	content = "<INS_CMD_HERE>"
	command = "fortune -n 75 -s | perl -0p -e 's/[\n\t]/ /g' "
}

window
{
	# window geometry
	x      = 100
	y      = 220
	width  = 120
	height = 50

	text_size        = large
	text_orientation = right
	text_color       = 0, 0, 240, 255
	cursor_color     = 0, 0,  240, 221

	# update time, 0 means do not update
	time = 0

	# window type, allowed values are:
	# "label", "button", "login", "password", "combo"
	type    = "label"
	content = "login:"
	linkto  = "login"
}

window
{
	# window geometry
	x      = 240
	y      = 220
	width  = 560
	height = 50

	text_size    = large
	text_color       = 0, 0, 240, 255
	cursor_color     = 0, 0,  240, 221

	# update time, 0 means do not update
	time = 0

	# window type, allowed values are:
	# "label", "button", "login", "password", "combo"
	type = "login"
}

window
{
	# window geometry
	x      = 100
	y      = 295
	width  = 120
	height = 50

	text_size        = large
	text_orientation = right
	text_color       = 0, 0, 240, 255
	cursor_color     = 0, 0,  240, 221

	# update time, 0 means do not update
	time = 0

	# window type, allowed values are:
	# "label", "button", "login", "password", "combo"
	type    = "label"
	content = "passwd:"
	linkto  = "password"
}

window
{
	# window geometry
	x      = 240
	y      = 295
	width  = 560
	height = 50

	text_size    = large
	text_color       = 0, 0, 240, 255
	cursor_color     = 0, 0,  240, 221

	# update time, 0 means do not update
	time = 0

	# window type, allowed values are:
	# "label", "button", "login", "password", "combo"
	type = "password"
}

window
{
	# window geometry
	x      = 100
	y      = 370
	width  = 120
	height = 50

	text_size        = large
	text_orientation = right
	text_color       = 0, 0, 240, 255
	cursor_color     = 0, 0,  240, 221

	# update time, 0 means do not update
	time = 0

	# window type, allowed values are:
	# "label", "button", "login", "password", "combo"
	type    = "label"
	content = "session:"
	linkto  = "session"
}

window
{
	# window geometry
	x      = 240
	y      = 370
	width  = 560
	height = 50

	text_size    = large
	text_color       = 0, 0, 240, 255
	cursor_color     = 0, 0,  240, 221

	# update time, 0 means do not update
	time = 0

	# window type, allowed values are:
	# "label", "button", "login", "password", "combo"
	type = "combo"

	# In this case: what text do you want to display?
	command = "sessions"
}


window
{
	# window geometry
	x    = 755
	y    = 562
	type = "button"

	# Allowed commands:
	# "halt", "reboot", "sleep", "screensaver"
	command = "halt"

	# Image prefix: will be converted to
	# "<name>_normal.png" and "<name>_mouseover.png"
	content = "power"
}

window
{
	x       = 755
	y       = 515
	type    = "button"
	command = "reboot"
	content = "reset"
}

window
{
	x       = 755
	y       = 470
	type    = "button"
	command = "screensaver"
	content = "screensaver"
}

window
{
	x       = 755
	y       = 425
	type    = "button"
	command = "sleep"
	content = "sleep"
}
@end verbatim

@node  Themes using settings file,  , Themes using theme files, Qingy Themes
@comment  node-name,  next,  previous,  up
@section Themes using settings file

In the setting file (@file{/etc/qingy/settings}), you may, since Qingy
0.3 define global theme properties exactly as you would in a theme
file: just begin a @code{theme@{...@}} section in your settings and
put everything you need there.

Please note that, being themes incremental, you can for example do
something like this:

@example

#... more of the setings file, not relevant here

theme="mytheme"

theme@{
        background="/usr/share/company_logo.png"
@}

@end example

and you will get theme @file{mytheme} with @code{background} set to
@file{/usr/share/company_logo.png}. 

@menu
* Random themes::               
@end menu

@node  Random themes,  , Themes using settings file, Themes using settings file
@comment  node-name,  next,  previous,  up
@subsection Random themes

You can also get a fresh new randomly selected theme from your theme
collection everytime you start Qingy (as every logout, for
example). Just put the line @code{theme random} in your
@file{settings} file instead of putting @code{theme="name"} and Qingy
will select for you a random theme each time.

Remember, you can bypass some properties using the inline theme
functionality:

@example

theme random

theme@{
        background="/usr/share/company_logo.png"
@}

@end example

is perfectly valid.

